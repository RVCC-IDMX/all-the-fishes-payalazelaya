<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>All the Fishes</title>
  </head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
  <body>
    <script>
      // The app
      const app = new PIXI.Application({
        width: 740,
        height: 600,
        backgroundColor: 0x9dc6ff,
      });

      //Give us the view
      document.body.appendChild(app.view);

      // Fishes for Aquarium
      const my_sprite = PIXI.Sprite.from('img/fish.png');
      const my_sprite2 = PIXI.Sprite.from('img/fish.png');
      const my_sprite3 = PIXI.Sprite.from('img/angel_fish.png');
      const my_sprite4 = PIXI.Sprite.from('img/blue_fish.png');
      const my_sprite5 = PIXI.Sprite.from('img/tropical_fish.png');
      const my_sprite6 = PIXI.Sprite.from('img/colorful_fish.png');

      //Bubbles for Aquarium
      const bubble = PIXI.Sprite.from('img/bubble.png');
      const bubble2 = PIXI.Sprite.from('img/bubble.png');
      const bubble3 = PIXI.Sprite.from('img/bubble.png');
      const bubble4 = PIXI.Sprite.from('img/bubble.png');

      const bubbles = [bubble, bubble2, bubble3, bubble4];

      bubbles.forEach((bubble) => {
        bubble.scale.set(0.1);
        bubble.anchor.set(1);
        bubble.position.set(Math.random() * 650, Math.random() * 550);
      });

      //Scale the fishes
      my_sprite.scale.set(1, 1);
      my_sprite2.scale.set(-0.5, 0.5);
      my_sprite3.scale.set(0.3, 0.3);
      my_sprite4.scale.set(-0.1, 0.1);
      my_sprite5.scale.set(0.2, 0.2);
      my_sprite6.scale.set(0.3, 0.3);

      // Position the fishes
      my_sprite.x = 100;
      my_sprite.y = 100;
      my_sprite2.x = 500;
      my_sprite2.y = 350;
      my_sprite3.x = 300;
      my_sprite3.y = 550;
      my_sprite4.x = 700;
      my_sprite4.y = 200;
      my_sprite5.x = 500;
      my_sprite5.y = 50;
      my_sprite6.x = 30;
      my_sprite6.y = 60;

      // Flip the fishes
      my_sprite2.anchor.set(1);
      my_sprite3.anchor.set(1);

      // Tint the fishes
      my_sprite2.tint = 0x8b4000;
      my_sprite3.tint = 0x0e86d4;
      my_sprite4.tint = 0xffff00;
      my_sprite5.tint = 0xffc0cb;
      my_sprite6.tint = 0xff0000;

      //Background
      const tank = PIXI.Sprite.from('img/fish_tank.png');
      tank.scale.set(1.55, 1.55);
      tank.x = 0;
      tank.y = 0;

      //Create fish container
      const my_container = new PIXI.Container();

      //Add fish to container
      my_container.addChild(tank);
      my_container.addChild(my_sprite);
      my_container.addChild(my_sprite2);
      my_container.addChild(my_sprite3);
      my_container.addChild(my_sprite4);
      my_container.addChild(my_sprite5);
      my_container.addChild(my_sprite6);

      my_container.addChild(bubble);
      my_container.addChild(bubble2);
      my_container.addChild(bubble3);
      my_container.addChild(bubble4);

      //Add to stage
      app.stage.addChild(my_container);

      app.stage.addChild(my_sprite);
      app.stage.addChild(my_sprite2);
      app.stage.addChild(my_sprite3);
      app.stage.addChild(my_sprite4);
      app.stage.addChild(my_sprite5);
      app.stage.addChild(my_sprite6);

      app.stage.addChild(bubble);
      app.stage.addChild(bubble2);
      app.stage.addChild(bubble3);
      app.stage.addChild(bubble4);

      let loop = () => {
        let time = Date.now();
        let wobble = Math.sin(time / 350) * 40;
        let wobble2 = Math.sin(time / 500) * 40;
        let wobble3 = Math.sin(time / 200) * 20;

        my_sprite2.x = 700 + wobble;
        my_sprite4.x = 500 + wobble2;
        my_sprite6.x = 400 + wobble3;

        my_sprite.y = 550 + wobble;
        my_sprite3.y = 400 + wobble2;
        my_sprite5.y = 400 + wobble3;

        bubbles.forEach((bubble) => {
          bubble.position.x -= 1;

          if (bubble.position.x < 0) {
            bubble.position.x = 740;
            bubble.position.y = Math.random() * 600;
          }
        });

        requestAnimationFrame(loop);
      };

      loop();
    </script>
  </body>
</html>
